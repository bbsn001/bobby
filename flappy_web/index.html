<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Bobby Bird</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0a0a2e" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Bobby Bird" />
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png" />
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; background: #0a0a2e; font-family: Arial, sans-serif; overflow: hidden; -webkit-tap-highlight-color: transparent; -webkit-touch-callout: none; }
    canvas { display: block; touch-action: none; user-select: none; will-change: transform; transform: translateZ(0); -webkit-tap-highlight-color: transparent; -webkit-touch-callout: none; }
    .screen { position: fixed; inset: 0; background: #0a0a2e; display: flex; flex-direction: column; align-items: center; overflow-y: auto; -webkit-overflow-scrolling: touch; z-index: 100; }
    .screen-inner { width: 100%; max-width: 500px; padding: 32px 20px; display: flex; flex-direction: column; align-items: center; min-height: 100%; justify-content: center; }
    .screen-title { color: #ffd700; font-size: 2.2em; font-weight: bold; margin-bottom: 6px; text-align: center; }
    .screen-sub { color: #aaa; font-size: .88rem; margin-bottom: 24px; text-align: center; }
    .big-input { width: 80%; max-width: 280px; height: 58px; font-size: 16px; padding: 0 16px; text-align: center; border: 2px solid #ffd700; border-radius: 10px; background: #0f1432; color: #fff; outline: none; margin-bottom: 14px; }
    .big-input.error { border-color: #dc3232; }
    .btn { display: flex; align-items: center; justify-content: center; width: 80%; max-width: 280px; height: 56px; font-size: 1.1rem; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; touch-action: manipulation; margin-bottom: 10px; transition: filter .12s; }
    .btn:active { filter: brightness(.82); }
    .btn-yellow { background: #ffd700; color: #0f1432; } .btn-blue { background: #1a6aff; color: #fff; } .btn-dark { background: #1e1e4a; color: #aaa; border: 1px solid #333; }
    .btn-sm { height: 40px; font-size: .88rem; width: auto; padding: 0 18px; margin-bottom: 0; }
    .coins { color: #ffd700; font-size: 1.05rem; margin-bottom: 16px; }
    .char-preview { display: flex; align-items: center; gap: 12px; background: #131340; border: 1px solid #2a2a6a; border-radius: 12px; padding: 10px 14px; margin-bottom: 20px; width: 80%; max-width: 280px; }
    .char-preview img { width: 48px; height: 48px; object-fit: cover; border-radius: 8px; background: #0f1432; }
    .cp-name { color: #fff; font-weight: bold; font-size: .9rem; } .cp-bonus { color: #8be; font-size: .72rem; margin-top: 2px; }
    .shop-header { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 18px; }
    .shop-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; width: 100%; }
    @media (min-width: 460px) { .shop-grid { grid-template-columns: repeat(3, 1fr); } }
    .char-card { background: #131340; border: 2px solid #2a2a6a; border-radius: 12px; padding: 10px 8px 10px; display: flex; flex-direction: column; align-items: center; gap: 5px; position: relative; }
    .char-card.active-card { border-color: #22b422; } .char-card.majka-card { border-color: #ffd700; box-shadow: 0 0 14px #ffd70055; }
    .char-card img { width: 68px; height: 68px; object-fit: cover; border-radius: 8px; background: #0f1432; }
    .cc-name { color: #fff; font-weight: bold; font-size: .85rem; text-align: center; } .cc-bonuses { color: #8be; font-size: .62rem; text-align: center; line-height: 1.35; min-height: 26px; }
    .cc-btn { width: 100%; height: 34px; font-size: .78rem; font-weight: bold; border: none; border-radius: 7px; cursor: pointer; touch-action: manipulation; margin-top: 2px; }
    .cc-btn.active { background: #22b422; color: #fff; } .cc-btn.select { background: #1a6aff; color: #fff; } .cc-btn.buy { background: #ffd700; color: #0f1432; } .cc-btn.locked { background: #1e1e4a; color: #444; cursor: default; }
    #charPicker { scrollbar-width: none; } #charPicker::-webkit-scrollbar { display: none; }
  </style>
</head>
<body>

<div id="nickScreen" class="screen">
  <div class="screen-inner">
    <div class="screen-title">üê¶ Bobby Bird</div>
    <div class="screen-sub">Zaloguj siƒô lub stw√≥rz konto (z PINem)</div>
    <input id="nickInput" class="big-input" type="text" maxlength="16" placeholder="Tw√≥j nick" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
    <input id="pinInput" class="big-input" type="password" maxlength="4" inputmode="numeric" placeholder="PIN (4 cyfry)" autocomplete="off" style="margin-bottom:8px" />
    <div id="loginError" style="color:#dc3232; font-size:14px; font-weight:bold; margin-bottom:12px; display:none;">B≈Çƒôdny PIN!</div>
    <button id="nickConfirm" class="btn btn-yellow">DALEJ ‚Üí</button>
  </div>
</div>

<div id="lobbyScreen" class="screen" style="display:none">
  <div class="screen-inner">
    <div class="screen-title" style="font-size:1.55em;margin-bottom:2px">Bobby Bird</div>
    <div id="lobbyNick" style="color:#aaa;font-size:.85rem;margin-bottom:10px"></div>
    <div id="lobbyCoins" class="coins">üéµ 0 coin√≥w</div>
    <div id="charPreview" class="char-preview">
      <img id="charPreviewImg" src="" alt="" />
      <div><div id="charPreviewName" class="cp-name">Bobby</div><div id="charPreviewBonus" class="cp-bonus">brak bonus√≥w</div></div>
    </div>
    <div id="charPicker" style="display:flex;overflow-x:auto;gap:8px;padding:4px 2px;width:100%;max-width:280px;margin-bottom:18px;-webkit-overflow-scrolling:touch"></div>
    <button id="lobbyPlay" class="btn btn-yellow">‚ñ∂ GRAJ</button>
    <button id="lobbyShop" class="btn btn-blue">üõí SKLEP</button>
    <button id="lobbySpikes" class="btn" style="display:none; background:#dc3232; color:#fff; margin-top:10px; border:2px solid #ff5555; box-shadow: 0 0 15px #dc323288;">üî• TRYB KOLC√ìW (HARDCORE)</button>
    <button id="lobbyStats" class="btn btn-dark" style="margin-top:10px;">üìä STATY</button>
  </div>
</div>

<div id="shopScreen" class="screen" style="display:none">
  <div class="screen-inner" style="justify-content:flex-start;padding-top:20px">
    <div class="shop-header">
      <button id="shopBack" class="btn btn-dark btn-sm">‚Üê WR√ìƒÜ</button>
      <div id="shopCoins" class="coins" style="margin:0">üéµ 0</div>
    </div>
    <div id="shopGrid" class="shop-grid"></div>
  </div>
</div>

<div id="statsScreen" class="screen" style="display:none">
  <div class="screen-inner" style="justify-content:flex-start;padding-top:20px">
    <div class="shop-header">
      <button id="statsBack" class="btn btn-dark btn-sm">‚Üê WR√ìƒÜ</button>
      <div class="coins" style="margin:0;color:#8be;">STATY</div>
    </div>
    <div style="width:100%; background:#131340; border:2px solid #2a2a6a; border-radius:12px; padding:20px; box-shadow: 0 4px 15px rgba(0,0,0,0.5);">
      <div style="color:#ffd700; font-size:1.1rem; font-weight:bold; margin-bottom:20px; text-align:center; letter-spacing:1px;">JAK BARDZO JESTE≈öCIE CHUJOWI</div>
      <div style="display:flex; justify-content:space-between; margin-bottom:12px; border-bottom:1px solid #2a2a6a; padding-bottom:8px;"><span style="color:#aaa;">Ile razy zdech≈Çe≈õ:</span><span id="statDeaths" style="color:#dc3232; font-weight:bold; font-size:1.1rem;">0</span></div>
      <div style="display:flex; justify-content:space-between; margin-bottom:12px; border-bottom:1px solid #2a2a6a; padding-bottom:8px;"><span style="color:#aaa;">Spocone klikniƒôcia:</span><span id="statJumps" style="color:#fff; font-weight:bold; font-size:1.1rem;">0</span></div>
      <div style="display:flex; justify-content:space-between; margin-bottom:12px; border-bottom:1px solid #2a2a6a; padding-bottom:8px;"><span style="color:#aaa;">Fuks w trybie Kolc√≥w:</span><span id="statSpikes" style="color:#fff; font-weight:bold; font-size:1.1rem;">0</span></div>
    </div>
  </div>
</div>

<div id="hud" style="position:fixed;top:0;left:0;width:100%;pointer-events:none;z-index:10;display:none">
  <span id="hudCoins" style="position:absolute;top:10px;left:10px;color:#ffd700;font:bold 15px Arial">üéµ0</span>
  <span id="hudScore" style="position:absolute;top:6px;right:10px;color:#fff;font:bold 28px Arial;transition:transform 0.1s ease">0</span>
  <span id="hudHeart" style="position:absolute;top:30px;left:10px;font:15px Arial"></span>
</div>

<canvas id="gameCanvas" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) translateZ(0)"></canvas>

<script type="module">
  import './js/firebase.js';
  import './js/audio.js';
  import './js/ui.js';
  import './js/engine.js';

  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js')
        .then(reg => console.log('Service Worker gotowy.', reg.scope))
        .catch(err => console.warn('B≈ÇƒÖd SW:', err));
    });
  }
</script>

</body>
</html>
